{% extends "base.html" %}
{% block content %}



{% if occurrences %}
<!-- output table -->
<div class="table-responsive">
<table class="table table-lg" style="white-space: nowrap; font-family: Verdana; font-weight: normal; font-style: normal;" >
    <tr>
        <th>#</th>
        <th>Rank</th>
        <th>Taxon</th>
        <th>Sex</th>
        <th>Det.</th>
        <th>Country</th>
        <th>Municipality</th>
        <th>Locality</th>
        <th>Habitat</th>
        <th>Date</th>
        <th>Method</th>
        <th>Leg.</th>
        <th>Event-ID</th>
    </tr>

    {% for rank in order %}
    {% for occurrence in occurrences %}
    {% if occurrence.taxonRank == rank %}
    
    <!-- Add colour to different taxonomic ranks -->
    {% if rank == "species" or rank == "spnov" %}
    <tr class="table-success">
    {% elif rank == "genus" or rank == "species-group" %}
    <tr class="table-primary">
    {% else %}
    <tr class="table-secondary">
    {% endif %}
        <!-- Row number -->
        <td><a class="btn btn-outline-dark btn-sm" href="{{ url_for('specimens.specimen_view', occurrence_id=occurrence.occurrenceID) }}" role="button">{{ loop.index }}</a></td>
        <!-- Taxon rank -->
        <td>{{ occurrence.taxonRank }}</td>
        <!-- Taxon -->
        <td>{{ occurrence.scientificName | scn_italic (occurrence.taxonRank, occurrence.scientificNameAuthorship) | safe }} {{occurrence.scientificNameAuthorship}} {% if occurrence.identificationQualifier %}, {{occurrence.identificationQualifier}}{% endif %}</td>
        <!-- Sex -->
        <td>{{ occurrence.sex | if_present }}</td>
        <!-- Identified by -->
        <td>{{ occurrence.identifiedBy }}, {{ occurrence.dateIdentified | string_to_date | date_format("%B %Y") }}</td>
        <!-- Country -->
        <td>{{ occurrence.country | if_present }}</td>
        <!-- Municipality -->
        <td>{{ occurrence.municipality | if_present }}</td>
        <!-- Locality -->
        <td>{{ occurrence.locality_1 | locality_format(occurrence.locality_2) }}</td>
        <!-- Habitat -->
        <td>
            {% if occurrence.substrateName %}
            <i>{{ occurrence.substrateName|scn_format}}</i>-{{ occurrence.substratePlantPart }}-{{ occurrence.substrateType }}
            {% elif occurrence.habitat %}
            {{ occurrence.habitat }}
            {% endif %}
        </td>
        <!-- Date -->
        <td>{{ occurrence.eventDate_1 | format_dates(occurrence.eventDate_2) | striptags }}</td>
        <!-- Method -->
        <td>{{ occurrence.samplingProtocol | if_present }}</td>
        <!-- Collected by -->
        <td>{{ occurrence.recordedBy | leg_format | if_present }}</td>
        <!-- Event-ID -->
        <td>
            <form action="/show_event" method="post">
                <input type="text" name="eventID" id="eventID" value="{{ occurrence.eventID }}" hidden>
                <button type="submit" class="btn btn-outline-dark btn-sm" name="action1" value="VALUE1">{{ occurrence.eventID }}</button>
            </form>
        </td>
    </tr>
    {% endif %}
    {% endfor %}
    {% endfor %}
</table>
</div>
{% else %}
<br>
<h5>No specimen records found</h5>
{% endif %}

{% endblock %}